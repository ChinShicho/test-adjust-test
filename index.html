<!DOCTYPE html>
    <html lang="en">
   <head>
      <style>
         a {
             font-size: 20px
             }
      </style>
   </head>
   <body>
      <ul>
      　 <li><a href="door-app-dev://myna">開発</a></li>
         <li><a href="door-app-stg://myna">検証</a></li>
         <li><a href="door-app://myna">本番</a></li>

          <li><a href="https://watch.tomotrade.jp?t=GOOGL">https://watch.tomotrade.jp?t=GOOGL</a></li>
         <li><a href="https://watch.tomotrade.jp?t=316A">https://watch.tomotrade.jp?t=316A</a></li>
          <li><a href="https://tt-api.tomotrade.jp/api/account/auth/monex/callback?code=wipMDJ7L&state=see212">https://tt-api.tomotrade.jp</a></li>
          <button id="openAppButton"
                class="w-full py-3 px-6 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-300 transform hover:scale-[1.01]">
            ネイティブアプリを開く
        </button>
      </ul>
   </body>
        <script>
        // --- 設定 ---
        // 開発者が設定した公式なApp Link URL
        const APP_LINK_URL = 'https://tt-api.tomotrade.jp/api';
        
        // App Linkが失敗した場合に試みるカスタムスキームURL (Optional)
        // Android OSがインターセプトできない場合、ブラウザがこれを開こうとする
        const CUSTOM_SCHEME_URL = 'myapp://item/12345'; 

        // App Linkが開かなかった場合のフォールバックURL (Play Storeなど)
        const FALLBACK_URL = 'https://play.google.com/store/apps/details?id=com.your.app.package';

        // アプリが開かれたかどうかを判断するためのタイムアウト (ミリ秒)
        // ブラウザが切り替わる前にタイムアウトが終了した場合、フォールバックを実行
        const TIMEOUT_MS = 2500; 

        document.getElementById('openAppButton').addEventListener('click', attemptOpenApp);

        function setStatus(message, isError = false) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            if (isError) {
                statusElement.className = 'mt-8 p-4 rounded-lg text-sm bg-red-100 text-red-700 transition-all duration-500';
            } else {
                statusElement.className = 'mt-8 p-4 rounded-lg text-sm bg-blue-100 text-blue-700 transition-all duration-500';
            }
        }

        /**
         * App Link およびフォールバックによるアプリ起動を試みるメインロジック
         */
        function attemptOpenApp() {
            setStatus("アプリリンクURL (" + APP_LINK_URL + ") を使ってアプリ起動を試みています...");

            const startTime = Date.now();
            
            // ------------------------------------------
            // 1. App Link URLを直接開く試み
            // ------------------------------------------
            
            // App Linkが設定されていれば、Android OSがこのナビゲーションをインターセプトし、アプリを起動する
            window.location.href = APP_LINK_URL;

            // ------------------------------------------
            // 2. 失敗時のフォールバック設定
            // ------------------------------------------
            
            // 一定時間内にアプリが開かれず、ブラウザがフォアグラウンドに残っている場合、App Linkは失敗したと見なす
            const timeout = setTimeout(() => {
                const elapsedTime = Date.now() - startTime;
                
                // 既にアプリが開かれていれば、このスクリプトは停止しているはず。
                // まだブラウザに残っている場合、App Linkは失敗したか、ユーザーが拒否した。

                if (elapsedTime >= TIMEOUT_MS) {
                    
                    // Option A: カスタムスキームを試みる (App Link非対応ブラウザ用)
                    // window.location.href = CUSTOM_SCHEME_URL;

                    // Option B: Play Storeへ誘導
                    setStatus("アプリ起動に失敗しました。Playストアへリダイレクトします...", true);
                    
                    // ユーザーエクスペリエンスのため、Play Storeへのリダイレクト前に短い遅延を入れる
                    setTimeout(() => {
                        window.location.href = FALLBACK_URL;
                    }, 500); 
                }
            }, TIMEOUT_MS);
            
            // ユーザーがアプリに切り替わったことを検出する方法はないため、
            // 唯一の確実な方法は、上記のタイムアウトとフォールバックに依存することです。
            
            // ブラウザの visibility change イベントを監視して、タブがバックグラウンドに行ったときに
            // タイムアウトをクリアする方法も有効ですが、ここではシンプル化しています。
        }

        // 初期ステータス設定
        setStatus("開始するにはボタンをクリックしてください。", false);
    </script>
</html>
